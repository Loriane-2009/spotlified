var O=Object.defineProperty;var P=(e,t,r)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var H=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var q=(e,t,r)=>P(e,typeof t!="symbol"?t+"":t,r);var m=(e,t,r)=>new Promise((a,n)=>{var i=o=>{try{h(r.next(o))}catch(f){n(f)}},u=o=>{try{h(r.throw(o))}catch(f){n(f)}},h=o=>o.done?a(o.value):Promise.resolve(o.value).then(i,u);h((r=r.apply(e,t)).next())});var ae=H(y=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();class N extends HTMLElement{connectedCallback(){this.innerHTML=`
      <a href="${this.getAttribute("href")}">
        <img src="${this.getAttribute("image_url")}" />
        <div class="artist-list-item-title">${this.getAttribute("name")}</div>
      </a>
    `}}customElements.define("artist-cover",N);const R=new CustomEvent("play_click"),D=new CustomEvent("favorite_click");class w extends HTMLElement{connectedCallback(){this.render()}attributeChangedCallback(){this.render()}render(){const t=this.getAttribute("favorite")=="true"?"favorite":"favorite_border";this.innerHTML=`<a href="#">
      <div class="list-item-title">${this.getAttribute("title")}</div>
      <div class="list-item-actions">
        <button type="button" class="icon-button favorite-button ">
          <span class="material-icons">${t}</span>
        </button>
        <button type="button" class="icon-button play-button">
          <span class="material-icons">play_arrow</span>
        </button>
      </div>
    </a>`,this.querySelector(".play-button").addEventListener("click",r=>{r.preventDefault(),this.dispatchEvent(R)}),this.querySelector(".favorite-button").addEventListener("click",r=>{r.preventDefault(),this.dispatchEvent(D)})}}q(w,"observedAttributes",["favorite"]);customElements.define("song-item",w);const l=e=>{var t,r;(t=document.querySelector("section.active"))==null||t.classList.remove("active"),(r=document.querySelector(`${e}-section`))==null||r.classList.add("active")},F=e=>{var t,r;(t=document.querySelector("nav a.active"))==null||t.classList.remove("active"),(r=document.querySelector(`nav a[href="${e}"]`))==null||r.classList.add("active")},J=document.querySelector("#search-trigger"),d=document.querySelector("#search-input");J.addEventListener("click",()=>{d.classList.toggle("active"),d.classList.contains("active")&&d.focus()});d.addEventListener("change",()=>{window.location.hash=`#search-${encodeURIComponent(d.value)}`});const v="https://webmob-ui-22-spotlified.herokuapp.com",g=e=>fetch(e).then(t=>t.json()),U=()=>g(`${v}/api/artists`),j=e=>g(`${v}/api/artists/${e}/songs`),B=e=>g(`${v}/api/songs/search/${e}`),A=document.querySelector("artist-list"),K=()=>m(y,null,function*(){A.innerHTML="",(yield U()).forEach(t=>{const r=document.createElement("artist-cover");r.setAttribute("image_url",t.image_url),r.setAttribute("name",t.name),r.setAttribute("href",`#artists-${t.id}`),A.append(r)})});function I(e){e=parseInt(e,10);let t=Math.floor(e/3600),r=Math.floor((e-t*3600)/60),a=e-t*3600-r*60;return r<10&&(r="0"+r),a<10&&(a="0"+a),r+":"+a}const s=document.querySelector("#audio-player"),z=document.querySelector("#player-thumbnail-image"),G=document.querySelector("#player-infos-song-title"),Q=document.querySelector("#player-infos-artist-name"),V=document.querySelector("#player-control-previous"),W=document.querySelector("#player-control-next"),$=document.querySelector("#player-control-play"),x=$.querySelector(".material-icons"),X=document.querySelector("#player-time-current"),Y=document.querySelector("#player-time-duration"),S=document.querySelector("#player-progress-bar"),C=document.querySelector("#logo");let c=[],b=null;const L=(e,t)=>{b=e,t&&(c=t),s.src=e.audio_url,s.play(),G.innerText=e.title,Q.innerText=e.artist.name,z.src=e.artist.image_url},Z=()=>{let e=c.indexOf(b)+1;e==c.length&&(e=0),L(c[e])},ee=()=>{let e=c.indexOf(b)-1;e==-1&&(e=c.length-1),L(c[e])};$.addEventListener("click",()=>{s.paused?s.play():s.pause()});V.addEventListener("click",ee);W.addEventListener("click",Z);S.addEventListener("change",e=>{s.currentTime=e.currentTarget.value});s.addEventListener("durationchange",()=>{S.max=s.duration,Y.innerText=I(s.duration)});s.addEventListener("timeupdate",()=>{S.value=s.currentTime,X.innerText=I(s.currentTime)});s.addEventListener("play",()=>{x.innerText="pause",C.classList.add("animated")});s.addEventListener("pause",()=>{x.innerText="play_arrow",C.classList.remove("animated")});const te=(e,t)=>localStorage.setItem(e,JSON.stringify(t)),p=e=>JSON.parse(localStorage.getItem(e)),re=()=>Object.keys(localStorage).map(p),ne=e=>localStorage.removeItem(e),k=document.querySelector(".list"),E=document.querySelector("#list-section h4"),T=e=>{k.innerHTML="",e.forEach(t=>{const r=document.createElement("song-item");r.setAttribute("title",t.title),r.setAttribute("favorite",!!p(t.id)),r.addEventListener("play_click",()=>{L(t,e)}),r.addEventListener("favorite_click",()=>{p(t.id)?ne(t.id):te(t.id,t),r.setAttribute("favorite",!!p(t.id)),_()}),k.appendChild(r)})},se=e=>m(y,null,function*(){const t=yield j(e);E.innerHTML=`Artistes > ${t[0].artist.name}`,T(t)}),ie=e=>m(y,null,function*(){const t=yield B(e);E.innerHTML=`RÃ©sultats de recherche pour : ${decodeURIComponent(e)}`,T(t)}),_=()=>{const e=re();E.innerHTML="Favoris",T(e)},M=()=>{const t=(window.location.hash||"#home").split("-");switch(F(t[0]),t[0]){case"#home":l("#home");break;case"#player":l("#player");break;case"#artists":t[1]?(l("#list"),se(t[1])):(l("#artists"),K());break;case"#search":l("#list"),ie(t[1]);break;case"#favorites":l("#list"),_();break}};window.addEventListener("hashchange",M);M()});export default ae();
